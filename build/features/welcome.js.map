{"version":3,"file":"welcome.js","sourceRoot":"","sources":["../../src/features/welcome.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,4EAAoD;AAKpD,IAAM,WAAW,GAAG,EAGnB,CAAA;AAED,mBAAe,UAAC,MAAc;IAC1B,MAAM,CAAC,EAAE,CAAC,gBAAgB,EAAE,UAAO,MAAM;;;;;oBAC7B,KAAK,GAAS,MAAM,MAAf,EAAE,EAAE,GAAK,MAAM,GAAX,CAAW;oBAExB,IAAI,GAAG,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC,CAAA;yBAE5B,CAAC,IAAI,EAAL,cAAK;oBACW,WAAM,wBAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,EAAA;;oBAAhD,OAAO,GAAG,SAAsC;oBACtD,IAAI,CAAC,OAAO;wBAAE,WAAM;oBAEZ,SAAS,GAAW,OAAO,UAAlB,EAAE,IAAI,GAAK,OAAO,KAAZ,CAAY;oBAC7B,OAAO,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,SAAS,CAAgB,CAAA;oBAClE,IAAI,GAAG,WAAW,CAAC,KAAK,CAAC,EAAE,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,CAAA;;;oBAGlD,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;wBACT,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,OAAK,EAAE,MAAG,CAAC;qBAI7C,CAAC,CAAA;;;;SACL,CAAC,CAAA;AACN,CAAC,EAAA;AAEY,QAAA,MAAM,GAAG;IAClB,WAAW,EAAE,iBAAiB;IAC9B,MAAM,EAAE,iBAAiB;CAC5B,CAAA","sourcesContent":["import { Client, TextChannel } from 'discord.js'\r\nimport welcomeSchema from '../models/welcome-schema'\r\n\r\n// 1. Load all the data when the bot starts up\r\n// 2. Load and store the data only when needed\r\n\r\nconst welcomeData = {} as {\r\n    // guildId: [channel, message]\r\n    [key: string]: [TextChannel, string]\r\n}\r\n\r\nexport default (client: Client) => {\r\n    client.on('guildMemberAdd', async (member) => {\r\n        const { guild, id } = member\r\n\r\n        let data = welcomeData[guild.id]\r\n\r\n        if (!data) {\r\n            const results = await welcomeSchema.findById(guild.id)\r\n            if (!results) return\r\n\r\n            const { channelId, text } = results\r\n            const channel = guild.channels.cache.get(channelId) as TextChannel\r\n            data = welcomeData[guild.id] = [channel, text]\r\n        }\r\n\r\n        data[0].send({\r\n            content: data[1].replace(/@/g, `<@${id}>`),\r\n            // allowedMentions: {\r\n            //     users: [],\r\n            // }\r\n        })\r\n    })\r\n}\r\n\r\nexport const config = {\r\n    displayName: 'Welcome Channel',\r\n    dbName: 'WELCOME_CHANNEL',\r\n}"]}