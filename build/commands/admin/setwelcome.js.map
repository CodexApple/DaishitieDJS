{"version":3,"file":"setwelcome.js","sourceRoot":"","sources":["../../../src/commands/admin/setwelcome.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,0DAAkC;AAElC,+EAAuD;AAEvD,kBAAe;IACX,QAAQ,EAAE,OAAO;IACjB,WAAW,EAAE,uCAAuC;IACpD,WAAW,EAAE,CAAC,eAAe,CAAC;IAC9B,OAAO,EAAE,CAAC;IACV,YAAY,EAAE,qBAAqB;IACnC,KAAK,EAAE,MAAM;IACb,QAAQ,EAAE,KAAK;IACf,SAAS,EAAE,IAAI;IACf,OAAO,EAAE;QACL;YACI,IAAI,EAAE,SAAS;YACf,WAAW,EAAE,qBAAqB;YAClC,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,oBAAS,CAAC,SAAS,CAAC,6BAA6B,CAAC,OAAO;SAClE;QACD;YACI,IAAI,EAAE,MAAM;YACZ,WAAW,EAAE,sBAAsB;YACnC,QAAQ,EAAE,IAAI;YACd,IAAI,EAAE,oBAAS,CAAC,SAAS,CAAC,6BAA6B,CAAC,MAAM;SACjE;KACJ;IAED,QAAQ,EAAE,UAAO,EAAqC;YAAnC,KAAK,WAAA,EAAE,OAAO,aAAA,EAAE,WAAW,iBAAA,EAAE,IAAI,UAAA;;;;;;wBAChD,IAAI,CAAC,KAAK;4BAAE,WAAO,yCAAyC,EAAA;wBAEtD,MAAM,GAAG,OAAO;4BAClB,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,EAAE;4BACnC,CAAC,CAAC,WAAW,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,CAAA;wBAE/C,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,KAAK,YAAY,EAAE;4BACzC,WAAO,4BAA4B,EAAA;yBACtC;wBAEG,IAAI,GAAG,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,CAAA;wBAEjD,IAAI,OAAO,EAAE;4BACT,IAAI,CAAC,KAAK,EAAE,CAAA;4BACZ,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;yBACxB;wBAED,WAAM,wBAAa,CAAC,gBAAgB,CAAC;gCACjC,GAAG,EAAE,KAAK,CAAC,EAAE;6BAChB,EAAE;gCACC,GAAG,EAAE,KAAK,CAAC,EAAE;gCACb,SAAS,EAAE,MAAM,CAAC,EAAE;gCACpB,IAAI,MAAA;6BACP,EAAE;gCACC,MAAM,EAAE,IAAI;6BACf,CAAC,EAAA;;wBARF,SAQE,CAAA;wBAEF,WAAO,sBAAsB,EAAA;;;;KAChC;CACQ,CAAA","sourcesContent":["import DiscordJS from 'discord.js'\r\nimport { ICommand } from 'wokcommands'\r\nimport welcomeSchema from '../../models/welcome-schema'\r\n\r\nexport default {\r\n    category: 'Admin',\r\n    description: 'Sets the welcome channel and message.',\r\n    permissions: ['ADMINISTRATOR'],\r\n    minArgs: 2,\r\n    expectedArgs: '<channel> <message>',\r\n    slash: 'both',\r\n    testOnly: false,\r\n    guildOnly: true,\r\n    options: [\r\n        {\r\n            name: 'channel',\r\n            description: 'The target channel.',\r\n            required: true,\r\n            type: DiscordJS.Constants.ApplicationCommandOptionTypes.CHANNEL,\r\n        },\r\n        {\r\n            name: 'text',\r\n            description: 'The welcome message.',\r\n            required: true,\r\n            type: DiscordJS.Constants.ApplicationCommandOptionTypes.STRING,\r\n        },\r\n    ],\r\n\r\n    callback: async ({ guild, message, interaction, args }) => {\r\n        if (!guild) return 'Please us this command within a server.'\r\n\r\n        const target = message\r\n            ? message.mentions.channels.first()\r\n            : interaction.options.getChannel('channel')\r\n\r\n        if (!target || target.type !== 'GUILD_TEXT') {\r\n            return 'Please tag a text channel.'\r\n        }\r\n\r\n        let text = interaction?.options.getString('text')\r\n\r\n        if (message) {\r\n            args.shift()\r\n            text = args.join(' ')\r\n        }\r\n\r\n        await welcomeSchema.findOneAndUpdate({\r\n            _id: guild.id\r\n        }, {\r\n            _id: guild.id,\r\n            channelId: target.id,\r\n            text,\r\n        }, {\r\n            upsert: true,\r\n        })\r\n\r\n        return 'Welcome channel set!'\r\n    },\r\n} as ICommand"]}